$(window).ready((function(){$("#hellopreloader").fadeOut("slow")}));let devUrl="https://api.konstructapp.com";triggerBtns();const check=()=>{if(!("serviceWorker"in navigator))throw new Error("No Service Worker support!");if(!("PushManager"in window))throw new Error("No Push API Support!")},registerServiceWorker=async()=>{const swRegistration=await navigator.serviceWorker.register("sw.min.js",{scope:"./"});return swRegistration},requestNotificationPermission=async()=>{const permission=await window.Notification.requestPermission();if("granted"!==permission)throw new Error("Permission not granted for Notification")},showLocalNotification=(title,body,swRegistration)=>{const options={body:body};swRegistration.showNotification(title,options)},progressiveF=async()=>{check();const swRegistration=await registerServiceWorker(),permission=await requestNotificationPermission()};progressiveF(),$((function(){let deferredPrompt=null,buttonInstall=$(".installAppPrompt");window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),deferredPrompt=e,$(".installAppPrompt").show()}),$(buttonInstall).on("click",(function(e){deferredPrompt.prompt(),deferredPrompt.userChoice.then(choiceResult=>{"accepted"===choiceResult.outcome?$(".installAppPrompt").slideUp():Cookies.set("install","false")})})),window.addEventListener("appinstalled",evt=>{$(".installAppPrompt").hide(),Cookies.set("install","true"),"default"===Notification.permission&&requestNotificationPermission()}),Cookies.get("install")&&("true"!==Cookies.get("install")?$(".installAppPrompt").show():$(".installAppPrompt").hide()),"?newlogin"===location.search&&("default"===Notification.permission&&requestNotificationPermission(),history.replaceState("KonstructApp | Demand and supply starts here","KonstructApp | Demand and supply starts here","./"))})),$(document).ready((function(){$("div.modal").on("show.bs.modal",(function(){var modal=this,hash=this.id;window.location.hash=hash,window.onhashchange=function(){location.hash?location.hash!==$(".modal.show").attr("id")&&$(".modal").modal("hide"):$(".modal").modal("hide")}})),$("div.modal").on("hidden.bs.modal",(function(){if("dynamic"===$(this).data("resource"))window.history.back();else{var hash=this.id,url=window.location.pathname+window.location.search;history.replaceState("",document.title,url)}})),$("div.modal button.close").on("click",(function(){window.history.back()})),$("div.modal").keyup((function(e){27==e.keyCode&&window.history.back()}))}));let makePreload=cssSelector=>{cssSelector=$(cssSelector),$(cssSelector).html('<div class="inline-loader"><img src="assets/img/preload.gif"></div>')},unmakePreload=cssSelector=>{cssSelector=$(cssSelector),$(cssSelector).html("")};function isEmpty(obj){for(var key in obj)if(obj.hasOwnProperty(key))return!1;return!0}function handleErrors(response){if("success"!==response.message)throw new Error(response.statusText);return response}function isStandalone(){return!!navigator.standalone||window.matchMedia("(display-mode: standalone)").matches}isStandalone()&&(window.addEventListener("load",(function(){window.history.pushState({noBackExitsApp:!0},"")})),window.addEventListener("popstate",(function(event){event.state&&event.state.noBackExitsApp&&window.history.pushState({noBackExitsApp:!0},"")})));var simulateOffline=$(".simulate-offline"),simulateOfflinePage=$(".simulate-offline-page"),simulateOnline=$(".simulate-online"),onlineMessage=$(".online-message"),offlineMessage=$(".offline-message"),detectedOnline="online-message-active",detectedOffline="offline-message-active";$(".offline-message").length||($("body").append('<p style="width:95%;margin:auto" class="offline-message ">No internet connection detected</p>'),$("body").append('<p style="width:95%;margin:auto" class="online-message ">You are back online. Welcome!</p>'));var status=document.getElementById("status"),log=document.getElementById("log"),onlineMessage=$(".online-message"),offlineMessage=$(".offline-message"),detectedOnline="online-message-active",detectedOffline="offline-message-active";function updateOnlineStatus(event){var condition=navigator.onLine?"online":"offline";onlineMessage.addClass(detectedOnline),offlineMessage.removeClass(detectedOffline),setTimeout((function(){onlineMessage.removeClass(detectedOnline)}),3e3)}function updateOfflineStatus(event){var condition=navigator.onLine?"online":"offline";offlineMessage.addClass(detectedOffline)}if(window.addEventListener("online",updateOnlineStatus),window.addEventListener("offline",updateOfflineStatus),isStandalone()){let preload_href=$("a:not(.no-ajaxy):not([data-toggle='tab']):not([href='#']):not([target='_blank']):not(:contains('#'))");$(preload_href).on("click",(function(evn){evn.preventDefault(),$("#hellopreloader").fadeIn("slow");let targetUrl=$(this).attr("href");targetUrl||$("#hellopreloader").fadeOut("linear"),setTimeout((function(){location.replace(targetUrl)}),600)}))}let talert=(message,type)=>{var toastr1;(new Toastr).show(message)},disableBtn=targetForm=>{let targetBtn=$(targetForm).find(":submit");$(targetBtn).attr("disabled","disabled"),$(targetBtn).attr("data-display",$(targetBtn).html()),$(targetBtn).html(' <span class="fa fa-spinner fa-spin"></span>')},resetBtn=targetForm=>{let targetBtn=$(targetForm).find(":submit");$(targetBtn).removeAttr("disabled"),$(targetBtn).html($(targetBtn).data("display"))},update_btn_state=(button_id,state)=>{let button=document.getElementById(button_id);"enable"===state?$(button).removeAttr("disabled"):"disable"===state&&$(button).attr("disabled","disabled")},hideModals=()=>{$(".modal").modal("hide")};function findGetParameter(parameterName){var result=null,tmp=[];return location.search.substr(1).split("&").forEach((function(item){(tmp=item.split("="))[0]===parameterName&&(result=decodeURIComponent(tmp[1]))})),result}function userFx(response){let userToken=response.token,userId=response.data._id,userData=response.data;localStorage.setItem("firstName",userData.firstName),localStorage.setItem("lastName",userData.lastName),localStorage.setItem("email",userData.email),localStorage.setItem("userPic",userData.userpic),$.ajax({type:"POST",url:"controllers/createssid",data:{token:userToken,user:userId}}).done((function(callback){let return_url=findGetParameter("return_url");talert("Redirecting..."),return_url?(return_url=return_url.replace("_sp_61_","="),return_url=return_url.replace("_sp_63_","?"),location.assign(return_url)):location.assign(".?newlogin")}))}function userUpdated(response){talert("Changes saved"),location.reload()}function passwordReset(response){talert("Password updated"),$("#resetPassword").reset()}function portfolioCreated(response){loadPortfolio("sub"),hideModals(),document.getElementById("new-portfolio").reset(),resetBtn($("#new-portfolio"));let modal="#create-new-portfolio";$(modal).find("#createPortfolio").attr("disabled","disabled"),$(modal).find(".upload-image-container .file-upload .file-upload__label svg").css("fill","#c2c5d9"),$(modal).find(".upload-image-container .file-upload .file-upload__label p").css("color","#c2c5d9"),$(modal).find(".upload-image-container .file-upload .file-upload__label p").text("No images selected")}function portfolioUpdated(response){talert("Edit successful"),loadPortfolio("sub"),hideModals(),resetBtn($("#edit-portfolio"))}function bidCreated(response){loadBids("sub"),hideModals(),document.getElementById("new-bid").reset(),$(".selectpicker").selectpicker("val","refresh"),resetBtn($("#new-bid"));let modal="#create-new-bid";$(modal).find("#createBid").attr("disabled","disabled"),$(modal).find(".upload-image-container .file-upload .file-upload__label svg").css("fill","#c2c5d9"),$(modal).find(".upload-image-container .file-upload .file-upload__label p").css("color","#c2c5d9"),$(modal).find(".upload-image-container .file-upload .file-upload__label p").text("No images selected")}function bidUpdated(response){talert("Edit successful"),loadBids("sub"),hideModals(),resetBtn($("#edit-bid"))}function bidCommentMade(response){talert("Comment successful"),loadBidComments(response.data.bid,"sub"),$('#commentForm [name="bidComments"]').val(" ")}function statusCommentMade(response){talert("Comment successful"),loadStatusComments(response.data.status,"sub"),$('#commentForm [name="statusComments"]').val(" ")}function profileBidCreated(response){recentBids("sub"),hideModals(),document.getElementById("new-bid").reset(),$(".selectpicker").selectpicker("val","refresh"),resetBtn($("#new-bid")),$("#createBid").attr("disabled","disabled"),$(".upload-image-container .file-upload .file-upload__label svg").css("fill","#c2c5d9"),$(".upload-image-container .file-upload .file-upload__label p").css("color","#c2c5d9"),$("#statusMessage").text("No images selected")}function statusCreated(response){document.getElementById("new-status").reset(),resetBtn($("#new-status")),loadStatus("sub"),$("#imageUploadStatus").html(""),$("#taggedPortfolio").html(""),$("#new-status .image-upload svg").css("fill","#c2c5d9"),$("#new-status").find("[name='portfolio']").val("")}function statusUpdated(response){talert("Edit successful"),loadStatus("sub"),hideModals(),resetBtn($("#edit-status"))}function employmentAdded(response){loadEmployments("sub"),document.getElementById("new-work-history").reset(),resetBtn($("#new-work-history")),hideModals()}function certificateAdded(response){loadCertificates("sub"),document.getElementById("new-certificate").reset(),resetBtn($("#new-certificate")),hideModals()}let submitForm=(formID,successFunction)=>{let targetForm=document.getElementById(formID),formType=$(targetForm).data("method"),formUrl=$(targetForm).data("action"),authtk=Cookies.get("token");disableBtn(targetForm);let formData=new FormData(targetForm);$.ajax({url:formUrl,type:formType,data:formData,processData:!1,contentType:!1,headers:{Authorization:`Bearer ${authtk}`}}).done((function(response){talert("Success"),window[`${successFunction}`](response)})).fail((function(jqXHR){try{switch(jqXHR.status){case 401:case 400:case 500:talert(jqXHR.statusText),resetBtn(targetForm);break;default:talert("Uncaught Error.\n"+jqXHR.statusText),resetBtn(targetForm)}}catch(err){resetBtn(targetForm),talert(jqXHR.statusText)}}))},submitData=(data,method,action,callback)=>{let authtk=Cookies.get("token");$.ajax({url:action,type:method,data:data,headers:{Authorization:`Bearer ${authtk}`}}).done((function(response){callback(void 0,response)})).fail((function(jqXHR){try{switch(jqXHR.status){case 401:case 400:throw talert(jqXHR.statusText),"Authentication error";case 500:throw talert(jqXHR.statusText),"Internal server error";case 404:throw talert(jqXHR.statusText),"Not found";default:throw talert(jqXHR.statusText),"Uncaught Error.\n"+jqXHR.statusText}}catch(err){talert(jqXHR.statusText),callback(err,jqXHR)}}))};function profilePictures(){let cropAndUpload=(formId,outputWidth,outputHeight,cropAR)=>{let cropper,targetForm=document.getElementById(formId),newImage=document.querySelector(`#${formId} .imagePreview`),inputTrig=document.querySelector(`#${formId} input.newUpload`),btnOkay=document.querySelector(`#${formId} .image_ok`),btnCancel=document.querySelector(`#${formId} .image_null`),bodyContent=document.querySelector(`#${formId} .modal_data`),bodyPreview=document.querySelector(`#${formId} .modal_preview`),bodyButtons=document.querySelector(`#${formId} .upload-action-btns`),pictureUploadName=$(inputTrig).attr("name");$(inputTrig).on("change",(function(evt){var tgt,files=(evt.target||window.event.srcElement).files;if($(bodyContent).slideUp(),$(bodyPreview).slideDown(),$(bodyButtons).slideDown(),FileReader&&files&&files.length){var fr=new FileReader;fr.onload=function(){newImage.src=fr.result},fr.readAsDataURL(files[0]),setTimeout((function(){cropper=new Cropper(newImage,{aspectRatio:cropAR,movable:!0,zoomable:!0,dragMode:"move",scalable:!1})}),1e3)}})),$(btnCancel).click((function(ev){ev.preventDefault(),$(bodyContent).slideDown(),$(inputTrig).val(""),$(bodyPreview).slideUp(),$(bodyButtons).slideUp(),cropper&&cropper.destroy()})),$(btnOkay).click((function(e){e.preventDefault(),disableBtn(targetForm),cropper.getCroppedCanvas({width:outputWidth,height:outputHeight}).toBlob(blob=>{const formData=new FormData;let formUrl=$(targetForm).data("action"),authtk=Cookies.get("token");formData.append(pictureUploadName,blob),$.ajax(formUrl,{method:"PUT",data:formData,processData:!1,contentType:!1,headers:{Authorization:`Bearer ${authtk}`}}).done((function(response){talert("Picture updated"),location.reload()})).fail((function(jqXHR){try{switch(jqXHR.status){case 401:talert(jqXHR.statusText),resetBtn(targetForm);break;default:talert("Uncaught Error.\n"+jqXHR.statusText),resetBtn(targetForm)}}catch(err){resetBtn(targetForm),talert(jqXHR.statusText)}}))})}))};cropAndUpload("userPictureUpload",120,120,1),cropAndUpload("userHeaderUpload",1920,640,16/9)}function searchUser(text){let root=$(document).find(".search-result-content");if($(root).html('<div class="loader-activity"><div class="indeterminate"></div></div>'),text){let reqData,action,method,matches=submitData({searchTerm:text},"POST",`${devUrl}/api/searchuser`,(error,response)=>{error?(talert(error),$(root).html("<h5 class='text-center'>Could not complete your search </h5>")):0==response.data.length?$(root).html("<h5 class='text-center'>Could not find any user that matches your search</h5>"):($(root).html(""),response.data.map((function(current_user){let userIsVerified=current_user.userIdentityVerify?'<span class="fa fa-check-circle text-primary">':"";$(root).append(`\n\t\t\t\t\t\t\t<div class="inline-items">\n\t\t\t\t\t\t\t\t<div class="author-thumb">\n\t\t\t\t\t\t\t\t\t<a href='user?id=${current_user.id}'>\n\t\t\t\t\t\t\t\t\t\t<img src="${current_user.userPic}" class='custom-bg' alt="${current_user.firstName}" style='width:40px'>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="notification-event">\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<a href='user?id=${current_user.id}'>\n\t\t\t\t\t\t\t\t\t\t<span class="h6 notification-friend"> ${current_user.firstName} ${current_user.lastName} </span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t<a href='user?id=${current_user.id}' >\n\t\t\t\t\t\t\t\t\t\t<span class="chat-message-item">${current_user.occupation}\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t<span style='color:#888da8;font-size:12.5px'> \n\t\t\t\t\t\t\t\t\t\t\t\t<i class='fa fa-location-circle'></i> ${current_user.state} \n\t\t\t\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<a href='user?id=${current_user.id}' style='float:right'>\n\t\t\t\t\t\t\t\t\t<span class="notification-icon">\n\t\t\t\t\t\t\t\t\t${userIsVerified}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`)})))})}}function copyToClipboard(text){if(window.clipboardData&&window.clipboardData.setData)return clipboardData.setData("Text",text);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var textarea=document.createElement("textarea");textarea.textContent=text,textarea.style.position="fixed",document.body.appendChild(textarea),textarea.select();try{return copy=document.execCommand("copy"),talert("Link copied to clipboard")}catch(ex){return talert("Copy link to clipboard failed.",ex),!1}finally{document.body.removeChild(textarea)}}}function shareLink(shareData){let shareUrl="https://app.konstructapp.com/"+shareData.url;navigator.share?navigator.share({title:"KonstructApp",text:shareData.text,url:shareUrl}).then(()=>talert("Successful share")).catch(error=>talert("Error sharing",error)):copyToClipboard(shareUrl)}$(".reset-attributes").on("click",(function(ev){ev.preventDefault();let targetForm=$(this).closest("form");$(targetForm).find("input").each((function(){let targetInput=$(this),oldVal=$(targetInput).data("defvalue"),newVal=$(targetInput).val();$(targetInput).val(oldVal),talert("Changes reversed")}))})),$("#status-container-toggle").click((function(e){e.preventDefault(),$("#status-container").toggle("slow","linear")})),$(".user-search").on("search",(function(e){let currentInput;e.preventDefault(),searchUser($(this).val())})),$(".user-search").on("input",(function(){0==$(this).val().length&&$(".search-result-content").html(" ")})),$(".user-search-form").on("submit",(function(e){let currentInput;e.preventDefault(),searchUser($(this).find("[type=search]").val())}));
//# sourceMappingURL=app.min.js.map